{{/* layouts/partials/site_footer.html */}}
<footer class="footer mt-6">

  {{ $links := site.Params.contact_links }}
  {{ $brands := site.Data.icons.brands }} {{/* mapa YAML con los SVG inline */}}

  {{ if $links }}
  <div class="container py-4">

    <div class="d-flex justify-content-center">
      <nav class="social-icons d-flex justify-content-center align-items-center flex-wrap gap-3 mb-3 mx-auto"
           aria-label="Redes sociales">

        {{ range $links }}
          {{ $name := .name | default .icon }}
          {{ $icon := .icon }}
          {{ $pack := .icon_pack | default "fas" }}

          <a class="social-link d-inline-flex align-items-center justify-content-center p-1"
             href="{{ .link }}"
             aria-label="{{ $name }}"
             {{ if (hasPrefix .link "http") }}target="_blank" rel="me noopener noreferrer"{{ end }}>

            {{/* 1) Iconify si el icono viene con "pack:icon" (p.ej. simple-icons:bluesky) */}}
            {{ if in $icon ":" }}
              <iconify-icon icon="{{ $icon }}" width="1.6em" height="1.6em" aria-hidden="true"></iconify-icon>

            {{/* 2) Pack "brands" (nuestro YAML) */}}
            {{ else if or (eq $pack "brands") (eq $pack "brand") (eq $pack "hb") }}
              {{ with index $brands $icon }}
                <span class="brand-icon" aria-hidden="true">{{ . | safeHTML }}</span>
              {{ else }}
                {{/* Fallback: intentamos FA brands por si acaso */}}
                <i class="fa-brands fa-{{ $icon }}" aria-hidden="true"></i>
              {{ end }}

            {{/* 3) Font Awesome (fas/fab/far) */}}
            {{ else }}
              {{ $faPack := cond (eq $pack "fab") "fa-brands"
                          (cond (eq $pack "fas") "fa-solid"
                          (cond (eq $pack "far") "fa-regular" $pack)) }}
              <i class="{{ $faPack }} fa-{{ $icon }}" aria-hidden="true"></i>
            {{ end }}

            <span class="sr-only visually-hidden">{{ $name }}</span>
          </a>
        {{ end }}

      </nav>
    </div>
  </div>
  {{ end }}

  <div class="container pb-4 text-center text-muted small">
    {{ with site.Params.footer_text }}
      {{ . | safeHTML }}
    {{ else }}
      <p>
        MetaDocencia, un proyecto con patrocinio fiscal de Code for Science &amp; Society.
        <a href="/license/">Licencia</a>
      </p>
      <p class="mb-0">
        Publicado con
        <a href="https://hugoblox.com/" target="_blank" rel="noopener">Hugo Blox Builder</a>.
      </p>
    {{ end }}
  </div>

  {{/* Cargamos Iconify por si algún ítem usa "pack:icon" */}}
  <script defer src="https://cdn.jsdelivr.net/npm/iconify-icon@2.1.0/dist/iconify-icon.min.js"></script>

</footer>
