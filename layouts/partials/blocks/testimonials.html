{{- $b := or (index . "block") . -}}
{{- $c := or (index $b "content") $b -}}
{{- $items := index $c "items" | default (slice) -}}

<section class="section" id="{{ index $b "id" | default "" }}">
  <div class="container">
    {{ with (index $c "title") }}<h2 class="text-center mb-4">{{ . | markdownify }}</h2>{{ end }}
    <div class="row g-4">
      {{ if gt (len $items) 0 }}
        {{ range $t := $items }}
          {{- $quote  := or (index $t "quote") (index $t "text") -}}
          {{- $author := or (index $t "author") (index $t "name") -}}
          {{- $role   := index $t "role" -}}
          {{- $avatar := or (index $t "avatar") (index $t "image") -}}
          <div class="col-md-6 col-lg-4">
            <div class="border rounded p-3 h-100">
              {{ with $quote }}<p class="mb-3">“{{ . | markdownify }}”</p>{{ end }}
              <div class="d-flex align-items-center gap-3">
                {{ with $avatar }}<img src="{{ (printf "/media/%s" .) | relURL }}" width="48" height="48" class="rounded-circle" alt="">{{ end }}
                <div>
                  <div class="fw-semibold">{{ $author | default "Anon." }}</div>
                  {{ with $role }}<div class="text-muted small">{{ . }}</div>{{ end }}
                </div>
              </div>
            </div>
          </div>
        {{ end }}
      {{ else }}
        <div class="col-12"><em>Sin testimonios aún</em></div>
      {{ end }}
    </div>
  </div>
</section>
